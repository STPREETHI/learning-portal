{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { UserRole } from './types';\n// Components\nimport { HeaderComponent } from './components/header/header.component';\nimport { LoginPageComponent } from './components/login-page/login-page.component';\nimport { SpinnerIconComponent } from './components/icons/spinner-icon.component';\nimport { ClassroomListComponent } from './components/classroom-list/classroom-list.component';\nimport { TutorDashboardComponent } from './components/tutor-dashboard/tutor-dashboard.component';\nimport { WardDashboardComponent } from './components/ward-dashboard/ward-dashboard.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./services/api.service\";\nimport * as i2 from \"@angular/common\";\nfunction AppComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5);\n    i0.ɵɵelement(1, \"app-spinner-icon\", 6);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"className\", \"w-10 h-10\");\n  }\n}\nfunction AppComponent_ng_container_4_app_login_page_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-login-page\", 8);\n    i0.ɵɵlistener(\"login\", function AppComponent_ng_container_4_app_login_page_1_Template_app_login_page_login_0_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r4.handleLogin($event));\n    })(\"register\", function AppComponent_ng_container_4_app_login_page_1_Template_app_login_page_register_0_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r6 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r6.handleRegister($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AppComponent_ng_container_4_ng_container_2_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵelement(1, \"app-spinner-icon\", 6);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"className\", \"w-10 h-10\");\n  }\n}\nfunction AppComponent_ng_container_4_ng_container_2_ng_container_2_app_classroom_list_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-classroom-list\", 14);\n    i0.ɵɵlistener(\"selectClassroom\", function AppComponent_ng_container_4_ng_container_2_ng_container_2_app_classroom_list_1_Template_app_classroom_list_selectClassroom_0_listener($event) {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r12.setSelectedClassroomId($event));\n    })(\"createClassroom\", function AppComponent_ng_container_4_ng_container_2_ng_container_2_app_classroom_list_1_Template_app_classroom_list_createClassroom_0_listener($event) {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r14 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r14.handleCreateClassroom($event));\n    })(\"joinClassroom\", function AppComponent_ng_container_4_ng_container_2_ng_container_2_app_classroom_list_1_Template_app_classroom_list_joinClassroom_0_listener($event) {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r15 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r15.handleJoinClassroom($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext(4);\n    i0.ɵɵproperty(\"classrooms\", ctx_r9.classrooms)(\"currentUser\", ctx_r9.currentUser);\n  }\n}\nfunction AppComponent_ng_container_4_ng_container_2_ng_container_2_app_tutor_dashboard_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-tutor-dashboard\", 15);\n    i0.ɵɵlistener(\"back\", function AppComponent_ng_container_4_ng_container_2_ng_container_2_app_tutor_dashboard_2_Template_app_tutor_dashboard_back_0_listener() {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r16 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r16.setSelectedClassroomId(null));\n    })(\"quizCreated\", function AppComponent_ng_container_4_ng_container_2_ng_container_2_app_tutor_dashboard_2_Template_app_tutor_dashboard_quizCreated_0_listener($event) {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r18 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r18.handleQuizCreated($event));\n    })(\"assignmentCreated\", function AppComponent_ng_container_4_ng_container_2_ng_container_2_app_tutor_dashboard_2_Template_app_tutor_dashboard_assignmentCreated_0_listener($event) {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r19 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r19.handleAssignmentCreated($event));\n    })(\"updateAttendance\", function AppComponent_ng_container_4_ng_container_2_ng_container_2_app_tutor_dashboard_2_Template_app_tutor_dashboard_updateAttendance_0_listener($event) {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r20 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r20.handleUpdateAttendance($event));\n    })(\"approveRequest\", function AppComponent_ng_container_4_ng_container_2_ng_container_2_app_tutor_dashboard_2_Template_app_tutor_dashboard_approveRequest_0_listener($event) {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r21 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r21.handleApproveRequest($event));\n    })(\"gradeAssignment\", function AppComponent_ng_container_4_ng_container_2_ng_container_2_app_tutor_dashboard_2_Template_app_tutor_dashboard_gradeAssignment_0_listener($event) {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r22 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r22.handleGradeAssignment($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext(4);\n    i0.ɵɵproperty(\"classroom\", ctx_r10.selectedClassroom)(\"allWards\", ctx_r10.allWards);\n  }\n}\nfunction AppComponent_ng_container_4_ng_container_2_ng_container_2_app_ward_dashboard_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-ward-dashboard\", 16);\n    i0.ɵɵlistener(\"quizCompleted\", function AppComponent_ng_container_4_ng_container_2_ng_container_2_app_ward_dashboard_3_Template_app_ward_dashboard_quizCompleted_0_listener($event) {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r23 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r23.handleQuizCompleted($event));\n    })(\"assignmentSubmitted\", function AppComponent_ng_container_4_ng_container_2_ng_container_2_app_ward_dashboard_3_Template_app_ward_dashboard_assignmentSubmitted_0_listener($event) {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r25 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r25.handleAssignmentSubmitted($event));\n    })(\"back\", function AppComponent_ng_container_4_ng_container_2_ng_container_2_app_ward_dashboard_3_Template_app_ward_dashboard_back_0_listener() {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r26 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r26.setSelectedClassroomId(null));\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r11 = i0.ɵɵnextContext(4);\n    i0.ɵɵproperty(\"classroom\", ctx_r11.selectedClassroom)(\"currentUser\", ctx_r11.currentUser);\n  }\n}\nfunction AppComponent_ng_container_4_ng_container_2_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, AppComponent_ng_container_4_ng_container_2_ng_container_2_app_classroom_list_1_Template, 1, 2, \"app-classroom-list\", 11);\n    i0.ɵɵtemplate(2, AppComponent_ng_container_4_ng_container_2_ng_container_2_app_tutor_dashboard_2_Template, 1, 2, \"app-tutor-dashboard\", 12);\n    i0.ɵɵtemplate(3, AppComponent_ng_container_4_ng_container_2_ng_container_2_app_ward_dashboard_3_Template, 1, 2, \"app-ward-dashboard\", 13);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r8.selectedClassroom);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r8.selectedClassroom && ctx_r8.currentUser.role === ctx_r8.userRoleEnum.Tutor);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r8.selectedClassroom && ctx_r8.currentUser.role === ctx_r8.userRoleEnum.Ward);\n  }\n}\nfunction AppComponent_ng_container_4_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, AppComponent_ng_container_4_ng_container_2_div_1_Template, 2, 1, \"div\", 9);\n    i0.ɵɵtemplate(2, AppComponent_ng_container_4_ng_container_2_ng_container_2_Template, 4, 3, \"ng-container\", 4);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.isLoading);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r3.isLoading);\n  }\n}\nfunction AppComponent_ng_container_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, AppComponent_ng_container_4_app_login_page_1_Template, 1, 0, \"app-login-page\", 7);\n    i0.ɵɵtemplate(2, AppComponent_ng_container_4_ng_container_2_Template, 3, 2, \"ng-container\", 4);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.currentUser);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.currentUser);\n  }\n}\nexport let AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    apiService;\n    currentUser = null;\n    classrooms = [];\n    allWards = [];\n    selectedClassroomId = null;\n    isLoading = false;\n    isAuthLoading = true;\n    userRoleEnum = UserRole;\n    constructor(apiService) {\n      this.apiService = apiService;\n    }\n    ngOnInit() {\n      const token = localStorage.getItem('token');\n      const user = localStorage.getItem('user');\n      if (token && user) {\n        try {\n          this.currentUser = JSON.parse(user);\n        } catch (e) {\n          this.handleLogout();\n        }\n      }\n      this.isAuthLoading = false;\n      if (this.currentUser) {\n        this.fetchData();\n      }\n    }\n    get selectedClassroom() {\n      return this.classrooms.find(c => c.id === this.selectedClassroomId);\n    }\n    fetchData() {\n      this.isLoading = true;\n      this.apiService.fetchInitialData().subscribe({\n        next: data => {\n          this.classrooms = data.classrooms;\n          this.allWards = data.allWards;\n          this.isLoading = false;\n        },\n        error: error => {\n          console.error(\"Failed to fetch initial data:\", error);\n          this.handleLogout();\n          this.isLoading = false;\n        }\n      });\n    }\n    updateClassroomState(updatedClassroom) {\n      const index = this.classrooms.findIndex(c => c.id === updatedClassroom.id);\n      if (index > -1) {\n        this.classrooms[index] = updatedClassroom;\n        this.classrooms = [...this.classrooms];\n      }\n    }\n    handleLogin({\n      name,\n      pass\n    }) {\n      this.apiService.login(name, pass).subscribe({\n        next: ({\n          user\n        }) => {\n          localStorage.setItem('user', JSON.stringify(user));\n          this.currentUser = user;\n          this.fetchData();\n        },\n        error: error => {\n          console.error(error);\n          alert(error.message || 'Login failed.');\n        }\n      });\n    }\n    handleRegister({\n      name,\n      pass,\n      role\n    }) {\n      this.apiService.register(name, pass, role).subscribe({\n        next: ({\n          user\n        }) => {\n          localStorage.setItem('user', JSON.stringify(user));\n          this.currentUser = user;\n          if (role === UserRole.Ward) {\n            this.allWards = [...this.allWards, user];\n          }\n          this.fetchData();\n        },\n        error: error => {\n          console.error(error);\n          alert(error.message || 'Registration failed.');\n        }\n      });\n    }\n    handleLogout() {\n      localStorage.removeItem('token');\n      localStorage.removeItem('user');\n      this.currentUser = null;\n      this.selectedClassroomId = null;\n      this.classrooms = [];\n      this.allWards = [];\n    }\n    setSelectedClassroomId(id) {\n      this.selectedClassroomId = id;\n    }\n    handleCreateClassroom({\n      name,\n      description\n    }) {\n      this.apiService.createClassroom(name, description).subscribe({\n        next: newClassroom => {\n          this.classrooms = [...this.classrooms, newClassroom];\n        },\n        error: error => {\n          console.error(error);\n          alert(error.message || 'Failed to create classroom.');\n        }\n      });\n    }\n    handleJoinClassroom(code) {\n      this.apiService.joinClassroom(code).subscribe({\n        next: () => {\n          alert(\"Join request sent to the tutor for approval.\");\n          this.fetchData(); // Refresh data to see pending request if applicable\n        },\n\n        error: error => {\n          console.error(error);\n          alert(error.message || 'Failed to join classroom.');\n        }\n      });\n    }\n    handleApproveRequest(wardId) {\n      if (this.selectedClassroomId) {\n        this.apiService.approveJoinRequest(this.selectedClassroomId, wardId).subscribe({\n          next: updatedClassroom => this.updateClassroomState(updatedClassroom),\n          error: error => console.error(error)\n        });\n      }\n    }\n    handleQuizCreated(quizData) {\n      if (this.selectedClassroomId) {\n        this.apiService.addQuizToClassroom(this.selectedClassroomId, quizData).subscribe({\n          next: updatedClassroom => this.updateClassroomState(updatedClassroom),\n          error: error => console.error(error)\n        });\n      }\n    }\n    handleAssignmentCreated(assignmentData) {\n      if (this.selectedClassroomId) {\n        this.apiService.addAssignmentToClassroom(this.selectedClassroomId, assignmentData).subscribe({\n          next: updatedClassroom => this.updateClassroomState(updatedClassroom),\n          error: error => console.error(error)\n        });\n      }\n    }\n    handleQuizCompleted({\n      quizId,\n      submission\n    }) {\n      if (this.selectedClassroomId) {\n        this.apiService.submitQuiz(this.selectedClassroomId, quizId, submission).subscribe({\n          next: updatedClassroom => this.updateClassroomState(updatedClassroom),\n          error: error => console.error(error)\n        });\n      }\n    }\n    handleAssignmentSubmitted({\n      assignmentId,\n      submission\n    }) {\n      if (this.selectedClassroomId) {\n        this.apiService.submitAssignment(this.selectedClassroomId, assignmentId, submission).subscribe({\n          next: updatedClassroom => this.updateClassroomState(updatedClassroom),\n          error: error => console.error(error)\n        });\n      }\n    }\n    handleGradeAssignment({\n      assignmentId,\n      wardId,\n      grade,\n      feedback\n    }) {\n      if (this.selectedClassroomId) {\n        this.apiService.gradeAssignment(this.selectedClassroomId, assignmentId, wardId, grade, feedback).subscribe({\n          next: updatedClassroom => this.updateClassroomState(updatedClassroom),\n          error: error => console.error(error)\n        });\n      }\n    }\n    handleUpdateAttendance(record) {\n      if (this.selectedClassroomId) {\n        this.apiService.updateAttendance(this.selectedClassroomId, record).subscribe({\n          next: updatedClassroom => this.updateClassroomState(updatedClassroom),\n          error: error => console.error(error)\n        });\n      }\n    }\n    static ɵfac = function AppComponent_Factory(t) {\n      return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.ApiService));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: AppComponent,\n      selectors: [[\"app-root\"]],\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 5,\n      vars: 3,\n      consts: [[1, \"min-h-screen\", \"bg-slate-50\", \"dark:bg-slate-900\", \"text-slate-900\", \"dark:text-slate-200\", \"font-sans\"], [3, \"isAuthenticated\", \"logout\"], [1, \"container\", \"mx-auto\", \"p-4\", \"sm:p-6\", \"lg:p-8\"], [\"class\", \"flex justify-center items-center h-screen\", 4, \"ngIf\"], [4, \"ngIf\"], [1, \"flex\", \"justify-center\", \"items-center\", \"h-screen\"], [3, \"className\"], [3, \"login\", \"register\", 4, \"ngIf\"], [3, \"login\", \"register\"], [\"class\", \"flex justify-center items-center h-[calc(100vh-10rem)]\", 4, \"ngIf\"], [1, \"flex\", \"justify-center\", \"items-center\", \"h-[calc(100vh-10rem)]\"], [3, \"classrooms\", \"currentUser\", \"selectClassroom\", \"createClassroom\", \"joinClassroom\", 4, \"ngIf\"], [3, \"classroom\", \"allWards\", \"back\", \"quizCreated\", \"assignmentCreated\", \"updateAttendance\", \"approveRequest\", \"gradeAssignment\", 4, \"ngIf\"], [3, \"classroom\", \"currentUser\", \"quizCompleted\", \"assignmentSubmitted\", \"back\", 4, \"ngIf\"], [3, \"classrooms\", \"currentUser\", \"selectClassroom\", \"createClassroom\", \"joinClassroom\"], [3, \"classroom\", \"allWards\", \"back\", \"quizCreated\", \"assignmentCreated\", \"updateAttendance\", \"approveRequest\", \"gradeAssignment\"], [3, \"classroom\", \"currentUser\", \"quizCompleted\", \"assignmentSubmitted\", \"back\"]],\n      template: function AppComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"app-header\", 1);\n          i0.ɵɵlistener(\"logout\", function AppComponent_Template_app_header_logout_1_listener() {\n            return ctx.handleLogout();\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(2, \"main\", 2);\n          i0.ɵɵtemplate(3, AppComponent_div_3_Template, 2, 1, \"div\", 3);\n          i0.ɵɵtemplate(4, AppComponent_ng_container_4_Template, 3, 2, \"ng-container\", 4);\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"isAuthenticated\", !!ctx.currentUser);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.isAuthLoading);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.isAuthLoading);\n        }\n      },\n      dependencies: [CommonModule, i2.NgIf, HeaderComponent, LoginPageComponent, SpinnerIconComponent, ClassroomListComponent, TutorDashboardComponent, WardDashboardComponent],\n      encapsulation: 2\n    });\n  }\n  return AppComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}