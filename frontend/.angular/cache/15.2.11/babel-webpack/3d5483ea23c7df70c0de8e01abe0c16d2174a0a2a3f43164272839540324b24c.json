{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/forms\";\nfunction QuizAnalyticsComponent_option_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 7);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const quiz_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", quiz_r4.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(quiz_r4.title);\n  }\n}\nfunction QuizAnalyticsComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵtext(1, \" Select a quiz to view analytics or create one first. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction QuizAnalyticsComponent_ng_template_9_div_0_li_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 18)(1, \"span\", 19);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 20);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const item_r7 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r7.question);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", item_r7.incorrectCount, \" incorrect\");\n  }\n}\nfunction QuizAnalyticsComponent_ng_template_9_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"div\", 11)(2, \"p\", 12);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\", 13);\n    i0.ɵɵtext(5, \"Average Score\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 11)(7, \"p\", 12);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"p\", 13);\n    i0.ɵɵtext(10, \"Participation Rate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"div\", 14)(12, \"h4\", 15);\n    i0.ɵɵtext(13, \"Most Difficult Questions\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"ul\", 16);\n    i0.ɵɵtemplate(15, QuizAnalyticsComponent_ng_template_9_div_0_li_15_Template, 5, 2, \"li\", 17);\n    i0.ɵɵpipe(16, \"slice\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r5.analytics.averageScore.toFixed(1), \"%\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r5.analytics.participationRate.toFixed(0), \"%\");\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind3(16, 3, ctx_r5.analytics.questionDifficulty, 0, 3));\n  }\n}\nfunction QuizAnalyticsComponent_ng_template_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtemplate(0, QuizAnalyticsComponent_ng_template_9_div_0_Template, 17, 7, \"div\", 9);\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.analytics);\n  }\n}\nexport let QuizAnalyticsComponent = /*#__PURE__*/(() => {\n  class QuizAnalyticsComponent {\n    classroom;\n    allWards = [];\n    selectedQuizId = null;\n    analytics = null;\n    enrolledWards = [];\n    selectedQuiz;\n    ngOnChanges(changes) {\n      if (changes['classroom'] || changes['allWards']) {\n        this.enrolledWards = this.allWards.filter(w => this.classroom.wardIds.includes(w.id));\n        if (!this.selectedQuizId && this.classroom.quizzes.length > 0) {\n          this.selectedQuizId = this.classroom.quizzes[0].id;\n        }\n        this.calculateAnalytics();\n      }\n    }\n    onQuizSelectionChange() {\n      this.calculateAnalytics();\n    }\n    calculateAnalytics() {\n      this.selectedQuiz = this.classroom.quizzes.find(q => q.id === this.selectedQuizId);\n      if (!this.selectedQuiz || this.enrolledWards.length === 0) {\n        this.analytics = null;\n        return;\n      }\n      const participationCount = new Set(this.selectedQuiz.submissions.map(s => s.wardId)).size;\n      const participationRate = participationCount / this.enrolledWards.length * 100;\n      const averageScore = this.selectedQuiz.submissions.length > 0 ? this.selectedQuiz.submissions.reduce((acc, sub) => acc + sub.score, 0) / this.selectedQuiz.submissions.length : 0;\n      const questionDifficulty = this.selectedQuiz.questions.map((q, index) => {\n        const incorrectCount = this.selectedQuiz.submissions.filter(s => s.answers[index] !== q.correctAnswer).length;\n        return {\n          question: q.question,\n          incorrectCount\n        };\n      }).sort((a, b) => b.incorrectCount - a.incorrectCount);\n      this.analytics = {\n        participationRate,\n        averageScore,\n        questionDifficulty\n      };\n    }\n    static ɵfac = function QuizAnalyticsComponent_Factory(t) {\n      return new (t || QuizAnalyticsComponent)();\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: QuizAnalyticsComponent,\n      selectors: [[\"app-quiz-analytics\"]],\n      inputs: {\n        classroom: \"classroom\",\n        allWards: \"allWards\"\n      },\n      standalone: true,\n      features: [i0.ɵɵNgOnChangesFeature, i0.ɵɵStandaloneFeature],\n      decls: 11,\n      vars: 4,\n      consts: [[1, \"bg-white\", \"dark:bg-slate-800\", \"rounded-lg\", \"shadow-lg\", \"p-6\", \"max-w-4xl\", \"mx-auto\"], [1, \"text-xl\", \"font-bold\", \"text-slate-800\", \"dark:text-white\", \"mb-4\"], [\"for\", \"quiz-select\", 1, \"block\", \"text-sm\", \"font-medium\", \"text-slate-700\", \"dark:text-slate-300\"], [\"id\", \"quiz-select\", 1, \"mt-1\", \"block\", \"w-full\", \"pl-3\", \"pr-10\", \"py-2\", \"text-base\", \"border-gray-300\", \"focus:outline-none\", \"focus:ring-sky-500\", \"focus:border-sky-500\", \"sm:text-sm\", \"rounded-md\", \"bg-white\", \"dark:bg-slate-700\", 3, \"ngModel\", \"ngModelChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"text-slate-500 dark:text-slate-400 text-center py-12\", 4, \"ngIf\", \"ngIfElse\"], [\"analyticsContent\", \"\"], [3, \"value\"], [1, \"text-slate-500\", \"dark:text-slate-400\", \"text-center\", \"py-12\"], [\"class\", \"mt-6 grid grid-cols-1 md:grid-cols-3 gap-6\", 4, \"ngIf\"], [1, \"mt-6\", \"grid\", \"grid-cols-1\", \"md:grid-cols-3\", \"gap-6\"], [1, \"bg-slate-50\", \"dark:bg-slate-700/50\", \"p-4\", \"rounded-lg\", \"text-center\"], [1, \"text-3xl\", \"font-bold\", \"text-sky-600\", \"dark:text-sky-400\"], [1, \"text-sm\", \"font-medium\", \"text-slate-500\", \"dark:text-slate-400\", \"mt-1\"], [1, \"col-span-1\", \"md:col-span-3\", \"bg-slate-50\", \"dark:bg-slate-700/50\", \"p-4\", \"rounded-lg\"], [1, \"font-semibold\", \"text-slate-700\", \"dark:text-slate-200\", \"mb-3\"], [1, \"space-y-2\"], [\"class\", \"flex items-start justify-between text-sm\", 4, \"ngFor\", \"ngForOf\"], [1, \"flex\", \"items-start\", \"justify-between\", \"text-sm\"], [1, \"text-slate-600\", \"dark:text-slate-300\", \"pr-4\"], [1, \"font-bold\", \"text-red-500\", \"whitespace-nowrap\"]],\n      template: function QuizAnalyticsComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h3\", 1);\n          i0.ɵɵtext(2, \"Quiz Analytics\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"div\")(4, \"label\", 2);\n          i0.ɵɵtext(5, \"Select a Quiz\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(6, \"select\", 3);\n          i0.ɵɵlistener(\"ngModelChange\", function QuizAnalyticsComponent_Template_select_ngModelChange_6_listener($event) {\n            return ctx.selectedQuizId = $event;\n          })(\"ngModelChange\", function QuizAnalyticsComponent_Template_select_ngModelChange_6_listener() {\n            return ctx.onQuizSelectionChange();\n          });\n          i0.ɵɵtemplate(7, QuizAnalyticsComponent_option_7_Template, 2, 2, \"option\", 4);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(8, QuizAnalyticsComponent_div_8_Template, 2, 0, \"div\", 5);\n          i0.ɵɵtemplate(9, QuizAnalyticsComponent_ng_template_9_Template, 1, 1, \"ng-template\", null, 6, i0.ɵɵtemplateRefExtractor);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          const _r2 = i0.ɵɵreference(10);\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngModel\", ctx.selectedQuizId);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngForOf\", ctx.classroom.quizzes);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.selectedQuiz)(\"ngIfElse\", _r2);\n        }\n      },\n      dependencies: [CommonModule, i1.NgForOf, i1.NgIf, i1.SlicePipe, FormsModule, i2.NgSelectOption, i2.ɵNgSelectMultipleOption, i2.SelectControlValueAccessor, i2.NgControlStatus, i2.NgModel],\n      encapsulation: 2\n    });\n  }\n  return QuizAnalyticsComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}